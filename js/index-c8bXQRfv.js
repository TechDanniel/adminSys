import{q as e,l as a,y as l,az as t,b6 as o,b7 as s,aL as n,A as i,d as r,V as m,o as p,a9 as u,w as c,a as d,aG as f,Y as h,H as y,ar as g,c as _,b8 as b,a6 as v,Z as j,b9 as k}from"./index-B_o8siDq.js";import{j as w,d as C,E as z,c as x,e as S,h as I,f as E,_ as D}from"./add-circle-line-BDU1sDx4.js";import"./el-checkbox-VUoa7duk.js";import"./el-tooltip-B01_nTLm.js";import"./el-scrollbar-Dkahi5v9.js";import{E as V}from"./el-tag-BiUEjuzt.js";import{a as R,E as Y}from"./el-form-item-jwksQNZh.js";import{E as O,a as T}from"./el-select-ChqbmI9X.js";import{E as $}from"./el-input-Cf2eIeua.js";import{d as A}from"./dayjs.min-Db6jUnK3.js";import{_ as F}from"./form.vue_vue_type_script_setup_true_lang-BmvzOelo.js";import{u as L}from"./hooks-Bjqg0XHe.js";import{E as M}from"./el-divider-CsesGZGr.js";import{u as W}from"./hooks-Br3HlGQj.js";import{_ as q}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-CneRhBR0.js";import"./el-space-1hjCJYd_.js";import"./isEqual-CcbjmHFc.js";import"./castArray-Doute4CP.js";import"./token-DWNpOE8r.js";import"./typescript-CRqm1_SZ.js";import"./el-row-BeMIhmV4.js";import"./el-radio-BCzj3Wry.js";import"./inconifyIconOffline-CFYy2gvx.js";const H={class:"main"},U=q(r({name:"SystemDept",__name:"index",setup(r){const q=a(),U=a(),{form:G,loading:J,columns:K,dataList:N,onSearch:Q,resetForm:X,openDialog:Z,handleDelete:B,handleSelectionChange:P,tagStyle:ee}=function(){const r=e({name:"",status:null}),m=a(),p=a([]),u=a(!0),{tagStyle:c}=L(),d=[{label:"部门名称",prop:"name",width:180,align:"left"},{label:"排序",prop:"sort",minWidth:70},{label:"状态",prop:"status",minWidth:100},{label:"创建时间",minWidth:200,prop:"createTime",formatter:({createTime:e})=>A(e).format("YYYY-MM-DD HH:mm:ss")},{label:"备注",prop:"remark",minWidth:320}];async function f(){u.value=!0;const{data:e}=await w();let a=e;t.isEmpty(r.name)||(a=a.filter((e=>e.name.includes(r.name)))),t.isEmpty(r.status)||(a=a.filter((e=>e.status===r.status))),p.value=o(a),setTimeout((()=>{u.value=!1}),500)}function h(e){if(!e||!e.length)return;const a=[];for(let l=0;l<e.length;l++)e[l].disabled=0===e[l].status,h(e[l].children),a.push(e[l]);return a}return l((()=>{f()})),{form:r,loading:u,columns:d,dataList:p,onSearch:f,resetForm:function(e){e&&(e.resetFields(),f())},openDialog:function(e="新增",a){s({title:`${e}部门`,props:{formInline:{higherDeptOptions:h(n(p.value)),parentId:(null==a?void 0:a.parentId)??0,name:(null==a?void 0:a.name)??"",principal:(null==a?void 0:a.principal)??"",phone:(null==a?void 0:a.phone)??"",email:(null==a?void 0:a.email)??"",sort:(null==a?void 0:a.sort)??0,status:(null==a?void 0:a.status)??1,remark:(null==a?void 0:a.remark)??""}},width:"40%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRender:()=>i(F,{ref:m,formInline:null}),beforeSure:(a,{options:l})=>{const t=m.value.getRef(),o=l.props.formInline;function s(){M.success(`您${e}了部门名称为${o.name}的这条数据`),a(),f()}t.validate((e=>{e&&s()}))}})},handleDelete:function(e){M.success(`您删除了部门名称为${e.name}的这条数据`),f()},handleSelectionChange:function(e){},tagStyle:c}}();function ae(){U.value.setAdaptive()}return(e,a)=>{const l=$,t=R,o=T,s=O,n=f,i=Y,r=V,w=x,A=k,F=z;return p(),m("div",H,[u(i,{ref_key:"formRef",ref:q,inline:!0,model:d(G),class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px] overflow-auto"},{default:c((()=>[u(t,{label:"部门名称：",prop:"name"},{default:c((()=>[u(l,{modelValue:d(G).name,"onUpdate:modelValue":a[0]||(a[0]=e=>d(G).name=e),placeholder:"请输入部门名称",clearable:"",class:"!w-[180px]"},null,8,["modelValue"])])),_:1}),u(t,{label:"状态：",prop:"status"},{default:c((()=>[u(s,{modelValue:d(G).status,"onUpdate:modelValue":a[1]||(a[1]=e=>d(G).status=e),placeholder:"请选择状态",clearable:"",class:"!w-[180px]"},{default:c((()=>[u(o,{label:"启用",value:1}),u(o,{label:"停用",value:0})])),_:1},8,["modelValue"])])),_:1}),u(t,null,{default:c((()=>[u(n,{type:"primary",icon:d(W)("ri:search-line"),loading:d(J),onClick:d(Q)},{default:c((()=>a[4]||(a[4]=[h(" 搜索 ")]))),_:1},8,["icon","loading","onClick"]),u(n,{icon:d(W)(d(C)),onClick:a[2]||(a[2]=e=>d(X)(q.value))},{default:c((()=>a[5]||(a[5]=[h(" 重置 ")]))),_:1},8,["icon"])])),_:1})])),_:1},8,["model"]),u(D,{title:"部门管理",columns:d(K),onRefresh:d(Q),onFullscreen:ae},{buttons:c((()=>[u(n,{type:"primary",icon:d(W)(d(I)),onClick:a[3]||(a[3]=e=>d(Z)())},{default:c((()=>a[6]||(a[6]=[h(" 新增部门 ")]))),_:1},8,["icon"])])),default:c((({size:e,dynamicColumns:l})=>[u(F,{ref_key:"tableRef",ref:U,loading:d(J),"table-layout":"auto","default-expand-all":"",size:e,data:d(N),"row-key":"id","header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onSelectionChange:d(P)},{default:c((()=>[(p(!0),m(y,null,g(l,(a=>(p(),_(w,{key:a.prop,showOverflowTooltip:"",label:a.label,prop:a.prop,align:"center",height:"50",style:{width:"100%"}},b({_:2},["status"===a.prop?{name:"default",fn:c((({row:a})=>[u(r,{size:e,style:v(d(ee)(a.status))},{default:c((()=>[h(j(1===a.status?"启用":"停用"),1)])),_:2},1032,["size","style"])])),key:"0"}:{name:"default",fn:c((({row:e})=>[])),key:"1"}]),1032,["label","prop"])))),128)),u(w,{fixed:"right",label:"Operations","min-width":"120"},{default:c((({row:l})=>[u(n,{class:"reset-margin",link:"",type:"primary",size:e,icon:d(W)(d(S)),onClick:e=>d(Z)("修改",l)},{default:c((()=>a[7]||(a[7]=[h(" 修改 ")]))),_:2},1032,["size","icon","onClick"]),u(n,{class:"reset-margin",link:"",type:"primary",size:e,icon:d(W)(d(I)),onClick:e=>d(Z)("新增",{parentId:l.id})},{default:c((()=>a[8]||(a[8]=[h(" 新增 ")]))),_:2},1032,["size","icon","onClick"]),u(A,{title:`是否确认删除部门名称为${l.name}的这条数据`,onConfirm:e=>d(B)(l)},{reference:c((()=>[u(n,{class:"reset-margin",link:"",type:"primary",size:e,icon:d(W)(d(E))},{default:c((()=>a[9]||(a[9]=[h(" 删除 ")]))),_:2},1032,["size","icon"])])),_:2},1032,["title","onConfirm"])])),_:2},1024)])),_:2},1032,["loading","size","data","onSelectionChange"])])),_:1},8,["columns","onRefresh"])])}}}),[["__scopeId","data-v-97acfd66"]]);export{U as default};
